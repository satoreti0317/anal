local player = game.Players.LocalPlayer
local screenGui = Instance.new("ScreenGui")
screenGui.ResetOnSpawn = false
screenGui.Name = "TeleportUI"
screenGui.Parent = player:WaitForChild("PlayerGui")

local teleportEnabled = false
local targetPlayer = nil
local teleportDistance = 10
local offsetY = 1
local uiOpen = true

-- ãƒ•ãƒ¬ãƒ¼ãƒ ä½œæˆ
local boxFrame = Instance.new("Frame")
boxFrame.Size = UDim2.new(0, 250, 0, 350)
boxFrame.Position = UDim2.new(1, -260, 0.5, -175)
boxFrame.BackgroundColor3 = Color3.new(0, 0, 0)
boxFrame.BackgroundTransparency = 0.5
boxFrame.Active = true
boxFrame.Draggable = true
boxFrame.Parent = screenGui

-- æŠ˜ã‚ŠãŸãŸã¿ãƒœã‚¿ãƒ³
local toggleButton = Instance.new("TextButton")
toggleButton.Size = UDim2.new(0, 30, 0, 30)
toggleButton.Position = UDim2.new(1, -35, 0, 5)
toggleButton.AnchorPoint = Vector2.new(1, 0)
toggleButton.Text = "â–²"
toggleButton.BackgroundColor3 = Color3.fromRGB(50, 50, 50)
toggleButton.TextColor3 = Color3.new(1, 1, 1)
toggleButton.BackgroundTransparency = 0.5
toggleButton.Parent = boxFrame

-- UIå‰Šé™¤ãƒœã‚¿ãƒ³
local deleteButton = Instance.new("TextButton")
deleteButton.Size = UDim2.new(0, 30, 0, 30)
deleteButton.Position = UDim2.new(1, -70, 0, 5)
deleteButton.AnchorPoint = Vector2.new(1, 0)
deleteButton.Text = "Ã—"
deleteButton.BackgroundColor3 = Color3.fromRGB(255, 50, 50)
deleteButton.TextColor3 = Color3.new(1, 1, 1)
deleteButton.BackgroundTransparency = 0.5
deleteButton.Parent = boxFrame

-- ãƒ—ãƒ¬ã‚¤ãƒ¤ãƒ¼ãƒªã‚¹ãƒˆ
local playerList = Instance.new("ScrollingFrame")
playerList.Size = UDim2.new(1, -20, 0, 240)
playerList.Position = UDim2.new(0, 10, 0, 40)
playerList.CanvasSize = UDim2.new(0, 0, 0, 0)
playerList.ScrollBarThickness = 8
playerList.BackgroundColor3 = Color3.new(0, 0, 0)
playerList.BackgroundTransparency = 0.5
playerList.ScrollBarImageColor3 = Color3.new(1, 1, 1)
playerList.Parent = boxFrame

local UIListLayout = Instance.new("UIListLayout")
UIListLayout.SortOrder = Enum.SortOrder.LayoutOrder
UIListLayout.Parent = playerList

-- æ›´æ–°ãƒœã‚¿ãƒ³
local refreshButton = Instance.new("TextButton")
refreshButton.Size = UDim2.new(0.5, -5, 0, 40)
refreshButton.Position = UDim2.new(0, 10, 0, 290)
refreshButton.Text = "ğŸ”„ æ›´æ–°"
refreshButton.BackgroundColor3 = Color3.fromRGB(50, 50, 50)
refreshButton.TextColor3 = Color3.new(1, 1, 1)
refreshButton.BackgroundTransparency = 0.5
refreshButton.Parent = boxFrame

-- ãƒªã‚»ãƒƒãƒˆãƒœã‚¿ãƒ³
local resetButton = Instance.new("TextButton")
resetButton.Size = UDim2.new(0.5, -5, 0, 40)
resetButton.Position = UDim2.new(0.5, 5, 0, 290)
resetButton.Text = "âŒ ãƒªã‚»ãƒƒãƒˆ"
resetButton.BackgroundColor3 = Color3.fromRGB(50, 50, 50)
resetButton.TextColor3 = Color3.new(1, 1, 1)
resetButton.BackgroundTransparency = 0.5
resetButton.Parent = boxFrame

-- é¸æŠãƒ©ãƒ™ãƒ«
local selectedLabel = Instance.new("TextLabel")
selectedLabel.Size = UDim2.new(1, -20, 0, 30)
selectedLabel.Position = UDim2.new(0, 10, 0, 330)
selectedLabel.BackgroundTransparency = 1
selectedLabel.TextColor3 = Color3.new(1, 1, 1)
selectedLabel.Text = "é¸æŠä¸­: ãªã—"
selectedLabel.TextScaled = true
selectedLabel.Parent = boxFrame

-- ãƒ—ãƒ¬ã‚¤ãƒ¤ãƒ¼ãƒªã‚¹ãƒˆã®æ›´æ–°é–¢æ•°
local function refreshPlayerList()
	for _, child in ipairs(playerList:GetChildren()) do
		if child:IsA("TextButton") then child:Destroy() end
	end
	for _, otherPlayer in ipairs(game.Players:GetPlayers()) do
		if otherPlayer ~= player then
			local button = Instance.new("TextButton")
			button.Size = UDim2.new(1, 0, 0, 30)
			button.Text = otherPlayer.DisplayName .. " (" .. otherPlayer.Name .. ")"
			button.BackgroundColor3 = Color3.fromRGB(50, 50, 50)
			button.BackgroundTransparency = 0.5
			button.TextColor3 = Color3.new(1, 1, 1)
			button.Parent = playerList
			button.MouseButton1Click:Connect(function()
				targetPlayer = otherPlayer
				selectedLabel.Text = "é¸æŠä¸­: " .. button.Text
			end)
		end
	end
	playerList.CanvasSize = UDim2.new(0, 0, 0, UIListLayout.AbsoluteContentSize.Y)
end

-- UIè¡¨ç¤ºåˆ‡æ›¿
local function updateUIVisibility()
	local show = uiOpen
	playerList.Visible = show
	refreshButton.Visible = show
	resetButton.Visible = show
	selectedLabel.Visible = show
	deleteButton.Visible = show
	boxFrame.Size = show and UDim2.new(0, 250, 0, 370) or UDim2.new(0, 250, 0, 40)
	toggleButton.Text = show and "â–²" or "â–¼"
end

-- å…¥å‡ºæ™‚ã«ãƒªã‚¹ãƒˆæ›´æ–°
game.Players.PlayerAdded:Connect(refreshPlayerList)
game.Players.PlayerRemoving:Connect(refreshPlayerList)

-- ãƒ†ãƒ¬ãƒãƒ¼ãƒˆé–¢æ•°
local function teleportToSelf()
	if teleportEnabled and targetPlayer then
		local targetRoot = targetPlayer.Character and targetPlayer.Character:FindFirstChild("HumanoidRootPart")
		local selfRoot = player.Character and player.Character:FindFirstChild("HumanoidRootPart")
		if targetRoot and selfRoot then
			targetRoot.CFrame = selfRoot.CFrame + selfRoot.CFrame.LookVector * teleportDistance + Vector3.new(0, offsetY, 0)
		end
	end
end

-- ãƒœã‚¿ãƒ³æ¥ç¶š
refreshButton.MouseButton1Click:Connect(refreshPlayerList)
resetButton.MouseButton1Click:Connect(function()
	targetPlayer = nil
	selectedLabel.Text = "é¸æŠä¸­: ãªã—"
end)
toggleButton.MouseButton1Click:Connect(function()
	uiOpen = not uiOpen
	updateUIVisibility()
end)
deleteButton.MouseButton1Click:Connect(function()
	screenGui:Destroy()
end)

-- ãƒã‚¦ã‚¹æ“ä½œ
local mouse = player:GetMouse()
mouse.Button2Down:Connect(function()
	if targetPlayer then teleportEnabled = true end
end)
mouse.Button2Up:Connect(function()
	teleportEnabled = false
end)

-- æ¯ãƒ•ãƒ¬ãƒ¼ãƒ ãƒ†ãƒ¬ãƒãƒ¼ãƒˆ
game:GetService("RunService").Heartbeat:Connect(teleportToSelf)

-- Uã‚­ãƒ¼ã§ã‚ªãƒ³ã‚ªãƒ•
game:GetService("UserInputService").InputBegan:Connect(function(input, gp)
	if not gp and input.KeyCode == Enum.KeyCode.U then
		teleportEnabled = not teleportEnabled
		print("ãƒ†ãƒ¬ãƒãƒ¼ãƒˆæ©Ÿèƒ½: ", teleportEnabled and "ã‚ªãƒ³" or "ã‚ªãƒ•")
	end
end)

-- åˆæœŸè¡¨ç¤º
updateUIVisibility()
refreshPlayerList()
