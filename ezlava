local Players = game:GetService("Players")
local LocalPlayer = Players.LocalPlayer

-- Lavaという名前のPartをすべて検索して削除
for _, obj in pairs(game:GetDescendants()) do
	if obj:IsA("BasePart") and obj.Name:lower() == "lava" then
		print("削除: " .. obj:GetFullName())
		obj:Destroy()
	end
end

-- "lava" を含む名前のPartを削除
for _, obj in pairs(workspace:GetDescendants()) do
	if obj:IsA("BasePart") and obj.Name:lower():find("lava") then
		obj:Destroy()
	end
end

-- 新しく追加される lava の Touch を無効化
workspace.DescendantAdded:Connect(function(desc)
	if desc:IsA("BasePart") and desc.Name:lower():find("lava") then
		desc.CanTouch = false
	end
end)

-- 既にある lava Part の Touch を無効化
for _, part in pairs(workspace:GetDescendants()) do
	if part:IsA("BasePart") and part.Name:lower():find("lava") then
		part.CanTouch = false
	end
end

local character = LocalPlayer.Character or LocalPlayer.CharacterAdded:Wait()
local humanoid = character:WaitForChild("Humanoid")

-- Healthの変化を無効にする
humanoid.HealthChanged:Connect(function()
	if humanoid.Health < humanoid.MaxHealth then
		humanoid.Health = humanoid.MaxHealth
	end
end)

-- 既存Lava Partに接触イベントがあれば削除
for _, obj in pairs(workspace:GetDescendants()) do
	if obj:IsA("BasePart") and obj.Name:lower():find("lava") then
		-- 安全のためすべての接触イベントをDisconnect
		for _, conn in ipairs(getconnections(obj.Touched)) do
			conn:Disable()
		end
		-- 物理的な接触も無効化
		obj.CanTouch = false
		obj.CanCollide = false -- 任意：通り抜け可能に
	end
end

-- 新たに追加されるLavaに対しても処理を適用
workspace.DescendantAdded:Connect(function(obj)
	if obj:IsA("BasePart") and obj.Name:lower():find("lava") then
		wait() -- 保険的な遅延
		for _, conn in ipairs(getconnections(obj.Touched)) do
			conn:Disable()
		end
		obj.CanTouch = false
		obj.CanCollide = false
	end
end)
